---
title: "Shiny Graphs"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readr)
library(tidyr)
```

*Comparing distributions of different statistics by club*

*Gathering the dataframe*

```{r}
RonaldoComplete <- read_csv("RonaldoComplete.csv")
```

```{r}
MessiComplete <- read_csv("MessiComplete.csv")
```

```{r}
MessiComplete1 <- MessiComplete %>%
  rename(TotApps = "MTotApps", TotAssists = "MTotAssists", TotGoals = "MTotGoals",ClubApps = "MClubApps",ClubAssists = "MClubAssists",ClubGoals = "MClubGoals",CoApps = "MCoApps",CoAssists = "MCoAssists",CoGoals = "MCoGoals")%>%
  mutate(Player = rep(c("Messi"), nrow(MessiComplete)))
```

```{r}
RonaldoComplete1 <- RonaldoComplete %>%
  rename(TotApps = "RTotApps", TotAssists = "RTotAssists", TotGoals = "RTotGoals",ClubApps = "RClubApps",ClubAssists = "RClubAssists",ClubGoals = "RClubGoals",CoApps = "RCoApps",CoAssists = "RCoAssists",CoGoals = "RCoGoals")%>%
  mutate(Player = rep(c("Ronaldo"), nrow(RonaldoComplete)))
```

```{r}
MessiRonaldoLonger <- rbind(MessiComplete1,RonaldoComplete1) %>%
  select(Year, Player, TotApps,TotAssists,TotGoals,ClubApps,
         ClubAssists,ClubGoals,CoApps,CoAssists,CoGoals)
```


```{r}
inputPanel(
  selectInput("x_2", label = "Type of Stat", 
             choices = c("Total Appearances" ="TotApps",
                         "Total Assists" ="TotAssists",
                         "Total Goals" ="TotGoals",
                         "Club Appearances" ="ClubApps",
                         "Club Assists" ="ClubAssists",
                         "Club Goals" ="ClubGoals",
                         "Country Appearances" ="CoApps",
                         "Country Assists" ="CoAssists",
                         "Country Goals" ="CoGoals"))
)
renderPlot({
  ggplot(MessiRonaldoLonger, aes_string(x = "Year", y = input$x_2)) + 
    geom_col()+
    facet_wrap(~Player)
})
```

```{r}
fluidPage(
  fluidRow( 
    column(width = 3,   
        wellPanel(                
          # data widget: selecting the variables 
          selectInput("y_5", label = "y-axis Variable:",
             choices = c("Total Appearances" ="TotApps",
                         "Total Assists" ="TotAssists",
                         "Total Goals" ="TotGoals",
                         "Club Appearances" ="ClubApps",
                         "Club Assists" ="ClubAssists",
                         "Club Goals" ="ClubGoals",
                         "Country Appearances" ="CoApps",
                         "Country Assists" ="CoAssists",
                         "Country Goals" ="CoGoals"), 
             selected="TotApps")
        )
      ),
    column(width = 8, 
             plotOutput("gap_plot_5",hover="hover_coord_5")
      )
    ),
  fluidRow(
      column(width = 12, 
             tableOutput("hover_data_5")
      )
  )
)

# render plot
output$gap_plot_5 <- renderPlot({
  ggplot(MessiRonaldoLonger, aes_string(x = "Year", y = input$y_5, color= "Player")) + 
    geom_point() + 
    theme(axis.text=element_text(size=16),
          axis.title=element_text(size=16) )
})
## render text for hovered point(s)
output$hover_data_5 <- renderTable({
   nearPoints(MessiRonaldoLonger, input$hover_coord_5)[,1:6]
  })
```
